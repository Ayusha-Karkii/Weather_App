<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>WeatherApp</title>
    <link rel="stylesheet" href="style.css" />
  </head>

  <body>
    <div class="chill">
      <!-- Search -->
      <div class="search">
        <input type="text" placeholder="Enter city name" spellcheck="false" />
        <button>
          <img
            style="height: 55px"
            src="https://cdn-icons-png.flaticon.com/128/10947/10947920.png"
          />
        </button>
      </div>

      <!-- Error message -->
      <p class="error" style="display: none; color: red; text-align: center">
        City not found. Please enter a valid city name.
      </p>

      <!-- City -->
      <div class="city">
        <h2 class="city-name">George Town</h2>
      </div>

      <!-- Date & Day -->
      <div class="dateday">
        <div class="date"></div>
        <div class="day" style="font-size: 20px"></div>
      </div>

      <!-- Temperature -->
      <div class="degree">
        <div class="temperature">
          <p class="temp">22°C</p>
          <img
            style="height: 180px"
            src="https://cdn0.iconfinder.com/data/icons/tuts/256/weather.png"
          />
        </div>
      </div>

      <!-- Details -->
      <div class="details">
        <div class="col">
          <img
            style="height: 40px"
            src="https://cdn1.iconfinder.com/data/icons/weather-471/128/HUMIDITY-256.png"
          />
          <div>
            <p class="humidity">50%</p>
            <p>Humidity</p>
          </div>
        </div>

        <div class="col">
          <img
            style="height: 40px"
            src="https://cdn-icons-png.flaticon.com/128/4115/4115904.png"
          />
          <div>
            <p class="pressure">1013 hPa</p>
            <p>Pressure</p>
          </div>
        </div>

        <div class="col">
          <img
            style="height: 40px"
            src="https://cdn0.iconfinder.com/data/icons/weather-navy-volume-2/64/Wind_Speed-64.png"
          />
          <div>
            <p class="wind">15 km/h</p>
            <p>Wind Speed</p>
          </div>
        </div>
      </div>
    </div>

    <script>
      const apiKey = "730314b40aa408701164c7f939ba4415";
      const apiUrl =
        "https://api.openweathermap.org/data/2.5/weather?units=metric&q=";

      const searchBox = document.querySelector(".search input");
      const searchBtn = document.querySelector(".search button");
      const weatherIcon = document.querySelector(".temperature img");
      const errorMsg = document.querySelector(".error");

      async function checkWeather(city) {
        try {
          const response = await fetch(apiUrl + city + `&appid=${apiKey}`);

          if (!response.ok) {
            errorMsg.style.display = "block";
            return;
          }

          errorMsg.style.display = "none";
          const data = await response.json();

          // City
          document.querySelector(".city-name").innerHTML = data.name;

          // Temp
          document.querySelector(".temp").innerHTML =
            Math.round(data.main.temp) + "°C";

          // Details
          document.querySelector(".humidity").innerHTML =
            data.main.humidity + "%";
          document.querySelector(".pressure").innerHTML =
            data.main.pressure + " hPa";
          document.querySelector(".wind").innerHTML = data.wind.speed + " km/h";

          // Date
          const now = new Date();
          const dateOptions = {
            year: "numeric",
            month: "long",
            day: "numeric",
          };
          document.querySelector(".date").innerHTML = now.toLocaleDateString(
            "en-US",
            dateOptions,
          );

          const days = [
            "Sunday",
            "Monday",
            "Tuesday",
            "Wednesday",
            "Thursday",
            "Friday",
            "Saturday",
          ];
          document.querySelector(".day").innerHTML = days[now.getDay()];

          // Weather Icon
          const weatherMain = data.weather[0].main.toLowerCase();

          if (weatherMain === "clouds") {
            weatherIcon.src =
              "https://cdn0.iconfinder.com/data/icons/tuts/256/weather.png";
          } else if (weatherMain === "clear") {
            weatherIcon.src =
              "https://cdn-icons-png.flaticon.com/128/6974/6974833.png";
          } else if (weatherMain === "rain") {
            weatherIcon.src =
              "https://cdn3.iconfinder.com/data/icons/nature-emoji/50/Raining-256.png";
          } else if (weatherMain === "drizzle") {
            weatherIcon.src =
              "https://cdn1.iconfinder.com/data/icons/weather-forecast-meteorology-color-1/128/weather-rain-light-256.png";
          } else if (weatherMain === "mist") {
            weatherIcon.src =
              "https://cdn1.iconfinder.com/data/icons/weather-forecast-meteorology-color-1/128/weather-foggy-256.png";
          } else if (weatherMain === "snow") {
            weatherIcon.src =
              "https://cdn-icons-png.flaticon.com/128/2315/2315309.png";
          }
        } catch (error) {
          errorMsg.style.display = "block";
        }
      }

      searchBtn.addEventListener("click", () => {
        checkWeather(searchBox.value.trim());
      });

      // Default city
      checkWeather("George Town");
    </script>
  </body>
</html>
